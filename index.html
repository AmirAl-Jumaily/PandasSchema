<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PandasSchema &#8212; pandas_schema 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pandasschema">
<h1><a class="toc-backref" href="#id1">PandasSchema</a><a class="headerlink" href="#pandasschema" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#pandasschema" id="id1">PandasSchema</a><ul>
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#installation" id="id3">Installation</a></li>
<li><a class="reference internal" href="#built-in-validators" id="id4">Built-in Validators</a></li>
<li><a class="reference internal" href="#custom-validators" id="id5">Custom Validators</a><ul>
<li><a class="reference internal" href="#simple-validators" id="id6">Simple Validators</a></li>
<li><a class="reference internal" href="#inheriting-from-elementvalidation" id="id7">Inheriting From ElementValidation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#development" id="id8">Development</a></li>
<li><a class="reference internal" href="#api" id="id9">API</a><ul>
<li><a class="reference internal" href="#schema" id="id10">Schema</a></li>
<li><a class="reference internal" href="#column" id="id11">Column</a></li>
<li><a class="reference internal" href="#validation-warning" id="id12">Validation_Warning</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>PandasSchema is a module for validating tabulated data, such as CSVs (Comma Separated Value files), and TSVs (Tab
Separated Value files). It uses the incredibly powerful data analysis tool pandas to do so quickly and efficiently.</p>
<p>For example, say your code expects a CSV that looks a bit like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Given</span> <span class="n">Name</span><span class="p">,</span><span class="n">Family</span> <span class="n">Name</span><span class="p">,</span><span class="n">Age</span><span class="p">,</span><span class="n">Sex</span><span class="p">,</span><span class="n">Customer</span> <span class="n">ID</span>
<span class="n">Gerald</span><span class="p">,</span><span class="n">Hampton</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="n">Male</span><span class="p">,</span><span class="mi">2582</span><span class="n">GABK</span>
<span class="n">Yuuwa</span><span class="p">,</span><span class="n">Miyake</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="n">Male</span><span class="p">,</span><span class="mi">7951</span><span class="n">WVLW</span>
<span class="n">Edyta</span><span class="p">,</span><span class="n">Majewska</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">Female</span><span class="p">,</span><span class="mi">7758</span><span class="n">NSID</span>
</pre></div>
</div>
<p>Now you want to be able to ensure that the data in your CSV is in the correct format:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">pandas_schema</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Schema</span>
<span class="kn">from</span> <span class="nn">pandas_schema.validation</span> <span class="kn">import</span> <span class="n">LeadingWhitespaceValidation</span><span class="p">,</span> <span class="n">TrailingWhitespaceValidation</span><span class="p">,</span> <span class="n">CanConvertValidation</span><span class="p">,</span> <span class="n">MatchesPatternValidation</span><span class="p">,</span> <span class="n">InRangeValidation</span><span class="p">,</span> <span class="n">InListValidation</span>

<span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">([</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Given Name&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">LeadingWhitespaceValidation</span><span class="p">(),</span> <span class="n">TrailingWhitespaceValidation</span><span class="p">()]),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Family Name&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">LeadingWhitespaceValidation</span><span class="p">(),</span> <span class="n">TrailingWhitespaceValidation</span><span class="p">()]),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">InRangeValidation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)]),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">InListValidation</span><span class="p">([</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">])]),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Customer ID&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">MatchesPatternValidation</span><span class="p">(</span><span class="s1">r&#39;\d{4}[A-Z]{4}&#39;</span><span class="p">)])</span>
<span class="p">])</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Given Name,Family Name,Age,Sex,Customer ID</span>
<span class="s1">Gerald ,Hampton,82,Male,2582GABK</span>
<span class="s1">Yuuwa,Miyake,270,male,7951WVLW</span>
<span class="s1">Edyta,Majewska ,50,Female,775ANSID</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">))</span>

<span class="n">errors</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">errors</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
<p>PandasSchema would then output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">row</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="s2">&quot;Given Name&quot;</span><span class="p">}:</span> <span class="s2">&quot;Gerald &quot;</span> <span class="n">contains</span> <span class="n">trailing</span> <span class="n">whitespace</span>
<span class="p">{</span><span class="n">row</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="s2">&quot;Age&quot;</span><span class="p">}:</span> <span class="s2">&quot;270&quot;</span> <span class="n">was</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">range</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
<span class="p">{</span><span class="n">row</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="s2">&quot;Sex&quot;</span><span class="p">}:</span> <span class="s2">&quot;male&quot;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">legal</span> <span class="n">options</span> <span class="p">(</span><span class="n">Male</span><span class="p">,</span> <span class="n">Female</span><span class="p">,</span> <span class="n">Other</span><span class="p">)</span>
<span class="p">{</span><span class="n">row</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="s2">&quot;Family Name&quot;</span><span class="p">}:</span> <span class="s2">&quot;Majewska &quot;</span> <span class="n">contains</span> <span class="n">trailing</span> <span class="n">whitespace</span>
<span class="p">{</span><span class="n">row</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="s2">&quot;Customer ID&quot;</span><span class="p">}:</span> <span class="s2">&quot;775ANSID&quot;</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">match</span> <span class="n">the</span> <span class="n">pattern</span> <span class="s2">&quot;\d</span><span class="si">{4}</span><span class="s2">[A-Z]</span><span class="si">{4}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id3">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Install PandasSchema using pip:</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas_schema</span>
</pre></div>
</div>
</div>
<div class="section" id="built-in-validators">
<h2><a class="toc-backref" href="#id4">Built-in Validators</a><a class="headerlink" href="#built-in-validators" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="custom-validators">
<h2><a class="toc-backref" href="#id5">Custom Validators</a><a class="headerlink" href="#custom-validators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simple-validators">
<h3><a class="toc-backref" href="#id6">Simple Validators</a><a class="headerlink" href="#simple-validators" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to add your own Validator is to use the CustomValidation class. For example if you wanted a validation
that checked if each cell in a column contained the word 'fail', and failed if it did, you'd do the following:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CustomValidation</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="o">~</span><span class="n">s</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;fail&#39;</span><span class="p">),</span> <span class="s1">&#39;contained the word fail&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments to the CustomValidation constructor are listed here:</p>
</div>
<div class="section" id="inheriting-from-elementvalidation">
<h3><a class="toc-backref" href="#id7">Inheriting From ElementValidation</a><a class="headerlink" href="#inheriting-from-elementvalidation" title="Permalink to this headline">¶</a></h3>
<p>If you want to implement more complicated logic that doesn't fit in a lambda, or you want to parameterize your Validator
and re-use it in different parts of your application, you can instead make a class that inherits from ElementValidation.</p>
<p>For example, the (simplified) implementation of the MatchesRegexValidation is presented below. All you need to do is write
an <code class="code docutils literal"><span class="pre">__init__</span></code>, <code class="code docutils literal"><span class="pre">get_message</span></code> and <code class="code docutils literal"><span class="pre">validate</span></code> function with the same signatures as in this example, and you should be
able to use your validation as though it were a built-in Validation.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MatchesRegexValidation</span><span class="p">(</span><span class="n">ElementValidation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates that a regular expression can match somewhere in each element in this column</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regex</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">re</span><span class="o">.</span><span class="n">Pattern</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pattern</span> <span class="o">=</span> <span class="n">regex</span>

    <span class="k">def</span> <span class="nf">get_message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;does not match the regex &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">series</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="development">
<h2><a class="toc-backref" href="#id8">Development</a><a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h2>
<p>To install PandasSchema's development requirements, run</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>The setup.py can be run as an executable, and it provides the following extra commands:</p>
<ul class="simple">
<li><cite>./setup.py test</cite>: runs the tests</li>
<li><cite>./setup.py build_readme</cite>: rebuilds the <cite>README.rst</cite> from <cite>doc/readme/README.rst</cite></li>
<li><cite>./setup.py build_site --dir=&lt;dir&gt;</cite>: builds the documentation website from <cite>doc/site/index.rst</cite> into <cite>&lt;dir&gt;</cite></li>
</ul>
</div>
<div class="section" id="api">
<h2><a class="toc-backref" href="#id9">API</a><a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p>The public classes not documented above are shown here.</p>
<div class="section" id="schema">
<h3><a class="toc-backref" href="#id10">Schema</a><a class="headerlink" href="#schema" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="column">
<h3><a class="toc-backref" href="#id11">Column</a><a class="headerlink" href="#column" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="validation-warning">
<h3><a class="toc-backref" href="#id12">Validation_Warning</a><a class="headerlink" href="#validation-warning" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PandasSchema</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#built-in-validators">Built-in Validators</a></li>
<li><a class="reference internal" href="#custom-validators">Custom Validators</a><ul>
<li><a class="reference internal" href="#simple-validators">Simple Validators</a></li>
<li><a class="reference internal" href="#inheriting-from-elementvalidation">Inheriting From ElementValidation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#development">Development</a></li>
<li><a class="reference internal" href="#api">API</a><ul>
<li><a class="reference internal" href="#schema">Schema</a></li>
<li><a class="reference internal" href="#column">Column</a></li>
<li><a class="reference internal" href="#validation-warning">Validation_Warning</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Michael Milton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>